<!DOCTYPE html>
<html>
<head>
    <title>Patti Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            font-size: 14px;
            background-color: #f2f2f2;
        }
        label {
            width: 140px;
            display: inline-block;
            font-weight: bold;
        }
        input, textarea {
            width: 300px;
            margin-bottom: 10px;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .item-row {
            margin-bottom: 10px;
        }
        button {
            padding: 6px 12px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        .total-box {
            font-weight: bold;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h2>Patti Receipt Generator</h2>
    <form action="/generate" method="post">
        <label>Bill No:</label>
        <input name="bill_no" value="{{ next_bill_no }}" readonly><br>

        <label>Date:</label>
        <input type="date" name="date" required><br>

        <label>Name:</label>
        <input name="name" required><br>

        <label>Address:</label>
        <textarea name="address" rows="2"></textarea><br>

        <div id="items">
            <div class="item-row">
                <label>Item 1:</label>
                <input name="desc1" placeholder="Description">
                <label>₹</label>
                <input name="charge1" type="number" step="0.01" placeholder="Amount" oninput="calculateTotal()"><br>
            </div>
        </div>

        <button type="button" onclick="addItem()">+ Add Item</button><br><br>

        <div class="total-box">Total Amount: ₹ <span id="total">0.00</span></div><br>

        <label>Comments:</label>
        <textarea name="comments" rows="2"></textarea><br>

        <button type="submit">Download PDF</button>
    </form>

    <script>
        let count = 1;

        function addItem() {
            count++;
            const div = document.createElement("div");
            div.className = "item-row";
            div.innerHTML = `
                <label>Item ${count}:</label>
                <input name="desc${count}" placeholder="Description">
                <label>₹</label>
                <input name="charge${count}" type="number" step="0.01" placeholder="Amount" oninput="calculateTotal()"><br>`;
            document.getElementById("items").appendChild(div);
        }

        function calculateTotal() {
            let total = 0;
            for (let i = 1; i <= count; i++) {
                const charge = document.querySelector(`input[name='charge${i}']`);
                if (charge && charge.value) {
                    total += parseFloat(charge.value) || 0;
                }
            }
            document.getElementById("total").textContent = total.toFixed(2);
        }
    </script>
</body>
</html>
